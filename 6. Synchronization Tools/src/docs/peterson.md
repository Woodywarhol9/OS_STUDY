### Shared data와 Data inconsistency

먼저 ***동기화(Synchronization)** 는 멀티 프로세스 혹은 멀티 쓰레드 상황에서의 이슈이다.여러 개의 프로세스, 혹은 쓰레드가 공유된 자원, 데이터를 사용하는 경우, 스케줄링 시스템에 의해 **데이터의 일관성(Data Consistency)** 를 지키지 못하는 경우가 생기는데 이게 바로 문제다.

<br>

>>예를 들어, 내가 내 계좌에 1000원이 있다고 하자.
내가 500원을 출금하려고 하는 동시에, 친구가 내 계좌로 500원을 송금했다면, 내 잔고는 당연히 1000원이 있어야 맞다. 이 때 출금과 송금은 각각 독립된 다른 프로세스 혹은 쓰레드고, 이 두 개의 순서가 혼동된다면 잔고는 500원 혹은 1500원과 같은 결과를 내게 된다.
위와 같이, 공유 자원, 데이터에 대해 여러 개의 프로세스, 혹은 쓰레드가 동시에 접근해 문제를 야기할 수 있는 상황을 **경쟁 상황(Race Condition)** 이라한다.


##### 즉 데이터의 일관성을 위해, 멀티 프로세스 & 쓰레드 환경에서 접근체계를 조정해서 프로그램을 짜야하는데 이를 동기화라 한다.

### 용어 정리

동기화를 위해 하나의 프로세스 혹은 쓰레드가 공유 자원에 대한 작업이 완료될 때까지, 다른 프로세스, 쓰레드의 방해없이 완전하게 완료가 되어야 하는데, 이렇게 진행되는 원칙을 상호배제 원칙(Mutual Exclusion)라고 하고, 이렇게 수행되는 연산들을 Atomic Operation이라 한다. 또 이렇게 공유자원에 대해 동기화해야하는 코드 부분을 임계 영역(Critical Section)이라고 한다.

### Critical Section의 속성

임계 영역의 문제를 해결하기 위해서는 다음을 만족해야한다.

>1. 상호배제(Mutual Exclusion)
어떤 프로세스가 임계 영역을 실행하고 있을 때, 다른 프로세스는 임계 영역을 실행할 수 없다. 즉, 어떤 프로세스가 임계 영역을 실행할 때, 다른 프로세스는 코드 실행을 못하게 처리해줘야한다.

>2. 진행(Progress)
임계 영역에 실행되고 있는 프로세스가 없을 경우, 임계 영역을 실행하고자 기다리는 프로세스는 즉각적으로 임계 영역을 실행할 수 있어야 한다. 즉, 기다리고 있는 프로세스들에 대한 처리를 해줘야 한다.
(Deadlock 방지)

>3. 한정 대기(Bounded Waiting)
임계 영역을 실행하고자 하는 프로세스가 무한정으로 대기하면 안된다.
즉, 제한된 대기시간을 가져야한다. (Starvation 방지)

### Busy Waiting

CPU 스케쥴링에 의해, 각 프로세스가 running 된다. 이 때, 임계 영역에 들어가기 위해 기다리고 있는 프로세스는 위 코드에 의해 무한루프를 돌며 임계 영역 직전에 머무르게 되는데, 이 무한 루프에 CPU 자원을 쓰고 있는 것이다. 운영체제의 목표는 CPU를 효율적으로 활용하는 것이므로, 이러한 현상도 문제라고 본다. 이러한 문제를 **Busy waiting** 이라고 한다.